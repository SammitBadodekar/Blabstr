generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
  relationMode = "prisma"
}

model Users {
  id String @id @default(uuid())
  name String
  imageUrl String @db.Text
  bgImage String? @db.Text
  email String @unique
  password String?
  about String?
  tag String? @unique
  posts Posts[] @relation("posts")
  comments Comments[] @relation("comment")
  replies Replies[] @relation("reply")
  savedPosts Posts[]  @relation(name: "savedposts")
 likedPosts Posts[] @relation(name: "LikedPosts")
  followers Follow[] @relation("followers")
  following Follow[] @relation("following")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  isVerified Boolean @default(false)
}

model Posts {
  id String @id @default(uuid()) 
  type String
  text String?
  image String? @db.Text
  video String? @db.Text
  user    Users    @relation("posts",fields: [UserEmail], references: [email])
  UserEmail   String
  savedby  Users[] @relation(name: "savedposts")
  likedBy Users[] @relation(name: "LikedPosts")
  comments Comments[]
   createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  @@index([ UserEmail], name: "post_id_index")
}

model Comments{
  id String @id @default(uuid())
  text String
  post Posts  @relation(fields: [postId], references: [id])
  postId String 
  user    Users    @relation("comment",fields: [UserEmail], references: [email])
  UserEmail   String
  replies Replies[]
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  @@index([postId], name: "post_id_index")
  @@index([UserEmail], name: "Comment_id_index")
}

model Replies{
  id String @id @default(uuid())
  text String
  comment Comments  @relation(fields: [commentId], references: [id])
  commentId String
  user    Users    @relation("reply",fields: [UserEmail], references: [email])
  UserEmail   String 
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
 @@index([commentId], name: "post_id_index")
  @@index([UserEmail], name: "Reply_id_index")
}

model Follow{
  id String @id @default(uuid())
  followedby Users @relation("followers",fields: [followedbyEmail] , references: [email])
  followedbyEmail String
  followedTo Users @relation("following",fields: [followedToEmail] , references: [email])
  followedToEmail String
  @@index([followedbyEmail], name: "followers")
  @@index([followedToEmail], name: "following")
}

model FeaturedUsers {
  id String @id @unique
  name String
  email String @unique
  imageUrl String @db.Text
  about String?
  tag String? @unique
  isVerified Boolean @default(false)
}